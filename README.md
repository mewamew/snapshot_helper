# SnapTool - Windows 截屏工具

一款轻量级的 Windows 截屏工具,支持全局热键快速截图、区域选择和图像标注功能。

## 功能特性

- **全局热键触发**: 使用 `Shift+Alt+B` 在任何地方快速启动截图
- **区域选择**: 鼠标框选需要截取的屏幕区域
- **图像标注**: 支持在截图上进行涂鸦、画矩形、圆形、箭头等标注
- **多种工具**:
  - 自由画笔
  - 矩形标注
  - 圆形标注
  - 箭头标注(拖动控制方向和长度)
  - 橡皮擦(可用鼠标擦除特定区域的标注)
  - 3种颜色选择(红、绿、蓝)
  - 3种笔触粗细(适用于画笔、箭头和橡皮擦)
  - 撤回功能(撤销上一步操作)
- **自动保存**: 截图自动保存到系统临时目录
- **剪贴板集成**: 截图和文件路径自动复制到剪贴板,可直接粘贴
- **快捷确认**: 支持双击鼠标左键快速确认保存截图
- **系统托盘运行**: 最小化到系统托盘,不占用任务栏空间
- **多显示器支持**: 自动识别鼠标所在的显示器进行截图
- **高 DPI 支持**: 完美支持高分辨率显示器

## 系统要求

- Windows 10/11
- Python 3.8 或更高版本

## 安装

### 1. 克隆或下载项目

```bash
git clone <repository-url>
cd snap_tools
```

### 2. 创建虚拟环境

```bash
python -m venv venv
```

### 3. 激活虚拟环境并安装依赖

```bash
venv\Scripts\activate
pip install -r requirements.txt
```

## 使用方法

### 启动程序

双击运行 `run.bat` 或使用命令行:

```bash
run.bat
```

程序将在后台启动,并在系统托盘显示图标。

### 截图操作

1. **触发截图**: 按 `Shift+Alt+B`
2. **框选区域**: 鼠标拖动选择截图区域
3. **编辑标注**(可选):
   - 选择工具(画笔/矩形/圆形/箭头/橡皮擦)
   - 选择颜色和笔触粗细
   - 在截图上进行标注
     - 画笔：自由绘制
     - 矩形/圆形：拖动鼠标绘制形状
     - 箭头：从起点拖到终点，自动生成箭头指向
   - 使用橡皮擦工具擦除不需要的标注(可调节擦除粗细)
   - 点击撤回按钮可撤销上一步操作
4. **保存截图**:
   - 方式1: 点击工具栏中的 `✓` 确定按钮
   - 方式2: 在截图区域双击鼠标左键（快捷方式）
5. **取消截图**: 点击 `✕` 取消按钮或按 `ESC` 键

### 系统托盘操作

右键点击系统托盘图标可以:
- 手动触发截图
- 退出程序

## 开机自启动

运行 PowerShell 脚本来创建开机启动快捷方式:

```powershell
.\create_startup.ps1
```

注意: 需要管理员权限运行,或者修改脚本中的路径为实际安装路径。

## 项目结构

```
snap_tools/
├── snap_tool.py           # 主程序
├── run.bat                # 启动脚本
├── requirements.txt       # Python 依赖
├── create_startup.ps1     # 开机启动配置脚本
├── diag.py               # 显示器诊断工具
└── venv/                 # Python 虚拟环境
```

## 依赖项

- **PyQt6** (>= 6.0.0): GUI 框架
- **pynput** (>= 1.7.0): 全局热键监听
- **mss** (>= 9.0.0): 跨平台截屏库
- **Pillow** (>= 10.0.0): 图像处理

## 截图保存位置

截图默认保存在系统临时目录:

```
%TEMP%\screenshots\
```

文件名格式: `screenshot_YYYYMMDD_HHMMSS.png`

## 故障排查

### 诊断显示器信息

如果遇到多显示器问题,可运行诊断工具:

```bash
venv\Scripts\python.exe diag.py
```

### 常见问题

1. **热键不响应**: 确保程序正在运行(检查系统托盘图标)
2. **截图模糊**: 程序已启用 DPI 感知,如果仍有问题,尝试重启程序
3. **多显示器问题**: 运行 `diag.py` 检查显示器配置

## 许可证

本项目仅供个人学习和使用。

## 开发

### 运行调试版本

```bash
venv\Scripts\python.exe snap_tool.py
```

### 显示器诊断

```bash
venv\Scripts\python.exe diag.py
```
